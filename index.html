<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AquaClim Prestige - Devis & Factures</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
</head>

<body>
<div class="container">

  <!-- EN-TÃŠTE -->
  <header class="header">
    <div class="header-inner">
      <img src="logo.png" alt="AquaClim Prestige" class="header-logo" />
      <div>
        <h1>AquaClim Prestige</h1>
        <p class="subtitle">Entretien & DÃ©pannage - Climatisation & Piscine</p>
        <p class="contact">
          Le Blevennec LoÃ¯c â€“ 2 avenue Cauvin, 06100 Nice<br>
          TÃ©l : 06 03 53 77 73 â€“ Email : aquaclimprestige@gmail.com<br>
          SIRET : <strong>XXXXXXXXXXXXX</strong>
        </p>
      </div>
    </div>
  </header>

  <!-- ONGLET DEVIS / FACTURES -->
<div class="top-nav no-print">
  <button
    id="tabDevis"
    class="btn tab-btn active"
    onclick="switchListType('devis')"
  >
    ğŸ“„ Devis
  </button>

  <!-- ğŸ‘‰ Nouveau bouton contrat ICI -->
  <button
    id="tabContrat"
    class="btn tab-btn"
    type="button"
    onclick="openContractView()"
  >
    ğŸ“˜ Contrat Piscine / Spa
  </button>

  <button
    id="tabFactures"
    class="btn tab-btn"
    onclick="switchListType('facture')"
  >
    ğŸ’° Factures
  </button>
</div>


  <!-- LISTE DES DOCUMENTS -->
  <section id="listView">

  <div class="actions no-print">
  <button id="createDevis" class="btn btn-primary" onclick="newDocument('devis')">
    â• Nouveau devis
  </button>

  <button id="createFacture" class="btn btn-success" onclick="newDocument('facture')">
    â• Nouvelle facture
  </button>

  <button class="btn btn-devis tarifs-button" onclick="openTarifsPanel()">
    ğŸ“‹ Tarifs prestations
  </button>

  <button
    class="btn btn-primary"
    type="button"
    onclick="openClientsListPopup()"
  >
    ğŸ‘¥ Clients
  </button>
</div>


    <!-- PANEL TARIFS -->
    <div id="tarifsPanel" class="card no-print hidden">
      <h2>Tarifs des prestations</h2>

      <!-- actions top -->
      <div class="tarifs-actions tarifs-actions-top">
        <button class="btn btn-secondary" onclick="closeTarifsPanel()">â† Retour</button>
        <button class="btn btn-primary" onclick="saveTarifsFromUI()">ğŸ’¾ Enregistrer</button>
        <button class="btn btn-devis" onclick="openAddPrestationPopup()">â• Ajouter</button>
        <button class="btn btn-danger" onclick="resetTarifs()">ğŸ§¹ RÃ©initialiser</button>
      </div>

      <table class="documents-table">
        <thead>
          <tr>
            <th>Prestation</th>
            <th>Prix Particulier</th>
            <th>Prix Syndic</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="tarifsTableBody"></tbody>
      </table>

      <div id="descEditor" class="desc-editor hidden">
        <h4>Texte dÃ©taillÃ© du modÃ¨le</h4>
        <label>Texte Particulier</label>
        <textarea id="descPartInput"></textarea>

        <label>Texte Syndic / Agence</label>
        <textarea id="descSynInput"></textarea>

        <div class="desc-editor-buttons">
          <button class="btn btn-primary btn-small" onclick="saveDescEditor()">Enregistrer</button>
          <button class="btn btn-secondary btn-small" onclick="closeDescEditor()">Fermer</button>
        </div>
      </div>

      <div class="tarifs-actions tarifs-actions-bottom">
        <button class="btn btn-secondary" onclick="closeTarifsPanel()">â† Retour</button>
        <button class="btn btn-primary" onclick="saveTarifsFromUI()">ğŸ’¾ Enregistrer</button>
        <button class="btn btn-devis" onclick="openAddPrestationPopup()">â• Ajouter</button>
        <button class="btn btn-danger" onclick="resetTarifs()">ğŸ§¹ RÃ©initialiser</button>
      </div>
    </div>

    <!-- POPUP Ajouter prestation -->
    <div id="prestationPopup" class="popup-overlay hidden">
      <div class="popup">
        <h3 id="popupTitle">Nouvelle prestation</h3>

        <label>Nom de la prestation</label>
        <input type="text" id="popupName">

        <label>Prix Particulier</label>
        <input type="number" id="popupPricePart" step="0.01" oninput="onPopupPricePartChange()">

        <label>Prix Syndic</label>
        <input type="number" id="popupPriceSyn" step="0.01">

        <div class="popup-buttons">
          <button class="btn btn-primary" onclick="confirmPrestationPopup()">Valider</button>
          <button class="btn btn-secondary" onclick="closePrestationPopup()">Annuler</button>
        </div>
      </div>
    </div>

  <!-- TABLEAU DES DOCUMENTS -->
<div class="card">
  <div class="filters-row no-print">
    <span id="listTitle" class="list-title">Liste des devis</span>

    <!-- ğŸ” Recherche devis / factures -->
    <div class="doc-search-wrapper">
      <input
        type="text"
        id="docSearchInput"
        placeholder="Rechercher (nÂ°, client, objet...)"
        oninput="onDocumentsSearchChange()"
      />
    </div>

    <div id="yearFilterContainer" class="hidden">
      <label>AnnÃ©e</label>
      <select id="yearFilter" onchange="loadDocumentsList()">
        <option value="all">Toutes</option>
      </select>
    </div>

    <div id="exportContainer" class="hidden">
      <button class="btn btn-secondary btn-small" onclick="exportFacturesCSV()">ğŸ“¥ Exporter (CSV)</button>
    </div>
  </div>


      <table class="documents-table">
        <thead>
          <tr>
            <th>Type</th>
            <th>NumÃ©ro</th>
            <th>Client</th>
            <th>Date</th>
            <th>Montant</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
        </thead>

        <tbody id="documentsTableBody">
          <tr><td colspan="7" class="no-docs-cell">Aucun document pour le moment</td></tr>
        </tbody>
      </table>
    </div>

  </section>

  <!-- FORMULAIRE DOCUMENT -->
  <section id="formView" class="hidden">

    <div class="actions no-print">
      <button class="btn btn-secondary" onclick="backToList()">â† Retour</button>
      <button class="btn action-button" onclick="saveDocument()">ğŸ’¾ Enregistrer</button>
      <button class="btn action-button" onclick="openPrintable()">ğŸ–¨ï¸ Imprimer</button>
      <button class="btn action-button" onclick="duplicateCurrent()">ğŸ§¾ Dupliquer</button>
      <button id="transformButton" class="btn action-button" style="display:none;" onclick="transformToInvoice()">ğŸ” Facture</button>
      <button class="btn btn-danger" onclick="deleteCurrent()">ğŸ—‘ï¸ Supprimer</button>
    </div>

    <div class="card">
      <h2 id="formTitle">Nouveau document</h2>

      <!-- type document -->
      <div class="row">
        <div class="form-group">
          <label>Type *</label>
          <select id="docType" onchange="updateDocType(); updateTransformButtonVisibility();">
            <option value="devis">Devis</option>
            <option value="facture">Facture</option>
          </select>
        </div>

        <div class="form-group">
          <label>NumÃ©ro</label>
          <input type="text" id="docNumber" readonly>
        </div>

        <div class="form-group">
          <label>Date</label>
          <input type="date" id="docDate" onchange="onDocDateChange()">
        </div>

        <div class="form-group" id="validityDateGroup">
          <label>Valable jusquâ€™au</label>
          <input type="date" id="validityDate" onchange="onValidityChange()">
          <div id="devisStatusInfo" class="devis-status-info"></div>
        </div>
      </div>

      <div class="form-group">
        <label>Objet *</label>
        <input type="text" id="docSubject" placeholder="Ex : Entretien piscine + clim â€“ Villa Martin">
      </div>

      <!-- type client -->
      <div class="form-group">
        <label>Type client *</label>
        <div class="client-type-row">

          <label class="client-type-option">
            <input type="radio" name="clientType" value="particulier" id="clientParticulier" onchange="selectClientType('particulier')">
            Particulier
          </label>

          <label class="client-type-option">
            <input type="radio" name="clientType" value="syndic" id="clientSyndic" onchange="selectClientType('syndic')">
            Syndic / Agence
          </label>

        </div>
      </div>

      <!-- INFORMATIONS CLIENT -->
<h3 class="section-title">Informations client</h3>

<div class="row">
  <div class="form-group" style="max-width: 140px;">
    <label>CivilitÃ©</label>
    <select id="clientCivility">
      <option value="">â€”</option>
      <option value="Monsieur">Monsieur</option>
      <option value="Madame">Madame</option>
      <option value="Monsieur et Madame">Monsieur et Madame</option>
    </select>
  </div>

  <div class="form-group">
    <label>Nom ou SociÃ©tÃ© *</label>
    <input
      type="text"
      id="clientName"
      list="clientsList"
      autocomplete="off"
      required
      onchange="onClientNameChange()"
      onblur="onClientNameChange()"
    />
    <datalist id="clientsList"></datalist>
  </div>

  <!-- (le reste de tes champs Adresse / TÃ©lÃ©phone / Email ne bouge pas) -->
</div>


        <div class="form-group">
          <label>Adresse *</label>
          <input type="text" id="clientAddress">
        </div>

        <div class="form-group">
          <label>TÃ©lÃ©phone</label>
          <input type="tel" id="clientPhone">
        </div>

        <div class="form-group">
          <label>Email</label>
          <input type="email" id="clientEmail">
        </div>
      </div>

      <!-- boutons clients -->
     <div class="row no-print" style="gap:10px; display:flex;">

  <!-- Ajouter client -->
  <button
    type="button"
    class="btn btn-primary btn-small btn-icon"
    onclick="addCurrentClient()"
  >
    <span class="btn-icon-emoji">â•</span>
    <span>Ajouter ce client</span>
  </button>

  <!-- Voir liste clients -->
  <button
    type="button"
    class="btn btn-primary btn-small btn-icon"
    onclick="openClientsListPopup()"
  >
    <span class="btn-icon-emoji">ğŸ“‹</span>
    <span>Voir liste clients</span>
  </button>

  <!-- Supprimer client -->
  <button
    type="button"
    class="btn btn-danger btn-small btn-icon"
    onclick="deleteCurrentClient()"
  >
    <span class="btn-icon-emoji">ğŸ—‘ï¸</span>
    <span>Supprimer ce client</span>
  </button>

</div>

      <!-- Lieu dâ€™intervention (si syndic/agence) -->
    <div id="siteBlock" class="row" style="display:none;">

  <div class="form-group" style="max-width: 150px;">
    <label>CivilitÃ© lieu</label>
    <select id="siteCivility" style="min-width: 250px;">

      <option value="">â€”</option>
      <option value="Chez Monsieur">Chez Monsieur</option>
      <option value="Chez Madame">Chez Madame</option>
      <option value="Appartement Monsieur">Appartement Monsieur</option>
      <option value="Appartement Madame">Appartement Madame</option>
      <option value="Villa Monsieur">Villa Monsieur</option>
      <option value="Villa Madame">Villa Madame</option>
    </select>
  </div>

  <div class="form-group">
    <label>Nom du client sur site *</label>
    <input type="text" id="siteName" placeholder="Ex : Mme Dupont Ã‰lise">
  </div>

  <div class="form-group">
    <label>Adresse du lieu dâ€™intervention *</label>
    <input type="text" id="siteAddress" placeholder="Ex : RÃ©sidence Le Parc, BÃ¢t A, 14 rue ...">
  </div>

</div>


      <!-- PRESTATIONS -->
      <div class="prestations-section">
        <h3 class="section-title">Prestations</h3>

        <div id="prestationsContainer"></div>

        <button id="addPrestationBtn" class="btn action-button no-print" onclick="addPrestation()">
          â• Ajouter une prestation
        </button>
      </div>

      <!-- TOTAUX -->
      <div class="totals">

        <div class="total-line">
          <span>Sous-total HT :</span>
          <span id="subtotalHT">0,00 â‚¬</span>
        </div>

        <div class="totals-grid">

          <!-- RÃ©duction -->
          <div class="form-group discount-group">
            <label>RÃ©duction</label>
            <div class="discount-row">
              <label class="discount-toggle">
                <input type="checkbox" id="discountEnabled" onchange="onDiscountToggle()">
                Appliquer une rÃ©duction
              </label>

              <input type="number" id="discountPercentInput" min="0" max="100" value="0"
                     step="0.01" oninput="onDiscountPercentChange()" disabled>
              <span class="discount-percent-symbol">%</span>
            </div>
          </div>

          <!-- TVA -->
          <div class="form-group tva-group">
            <label>TVA</label>

            <div class="tva-options">
              <label><input type="radio" name="tvaRadio" id="tva0" checked onchange="setTVA(0)"> 0 %</label>
              <label><input type="radio" name="tvaRadio" id="tva20" onchange="setTVA(20)"> 20 %</label>
            </div>

            <div class="tva-rate-wrapper">
              <input type="number" id="tvaRate" value="0" step="0.01" readonly>
              <span class="tva-percent-symbol">%</span>
            </div>
          </div>

        </div>

        <div id="discountLine" class="total-line" style="display:none;">
          <span id="discountLabel">RÃ©duction :</span>
          <span id="discountAmount">0,00 â‚¬</span>
        </div>

        <div class="total-line">
          <span>TVA :</span>
          <span id="tvaAmount">0,00 â‚¬</span>
        </div>

        <div class="total-line grand-total">
          <span id="totalLabel">NET Ã€ PAYER :</span>
          <span id="totalTTC">0,00 â‚¬</span>
        </div>

        <div class="tva-note" id="tvaNote">TVA non applicable, article 293 B du CGI.</div>
      </div>

      <!-- SECTION PAIEMENT (factures) -->
      <div class="form-group no-print" id="paymentSection">
        <label>RÃ¨glement</label>

        <div class="pay-line">
          <label><input type="radio" name="payMode" id="payNone" value="" checked onchange="onPayModeChange()"> Facture non rÃ©glÃ©e</label>
        </div>

        <div class="pay-line">
          <label><input type="radio" name="payMode" value="especes" id="payEspeces" onchange="onPayModeChange()"> EspÃ¨ces</label>
          <label><input type="radio" name="payMode" value="cb" id="payCB" onchange="onPayModeChange()"> Carte bancaire</label>
          <label><input type="radio" name="payMode" value="virement" id="payVirement" onchange="onPayModeChange()"> Virement</label>
          <label><input type="radio" name="payMode" value="cheque" id="payCheque" onchange="onPayModeChange()"> ChÃ¨que</label>
        </div>

        <div id="paymentDateWrapper" class="payment-date-wrapper">
          <label>Date de rÃ¨glement</label>
          <input type="date" id="paymentDate">
        </div>
      </div>

      <!-- Notes -->
      <div class="form-group">
        <label>Notes / Conditions</label>
        <textarea id="notes" placeholder="Conditions de paiement, garanties, etc."></textarea>
      </div>

      <!-- ACTIONS BAS -->
      <div class="form-actions no-print">
        <button class="btn action-button" onclick="saveDocument()">ğŸ’¾ Enregistrer</button>
        <button class="btn action-button" onclick="openPrintable()">ğŸ–¨ï¸ Imprimer</button>
        <button class="btn btn-secondary" onclick="backToList()">â† Retour</button>
      </div>

    </div>
  </section>
    <!-- PAGE CONTRAT PISCINE / SPA -->
  <section id="contractView" class="hidden">

<div class="actions no-print">
  <button class="btn btn-secondary" type="button" onclick="backToListFromContract()">â† Retour</button>
  <button class="btn action-button" type="button" onclick="saveContract()">ğŸ’¾ Enregistrer le contrat</button>
  <button class="btn action-button" type="button" onclick="printContract()">ğŸ–¨ï¸ Imprimer le contrat</button>
</div>


    <div class="card contract-card">
      <h2>Contrat dâ€™entretien Piscine / Spa</h2>
      <p class="contract-intro">
        Ce formulaire gÃ©nÃ¨re un contrat dâ€™entretien complet prÃªt Ã  Ãªtre signÃ© par le client
        (particulier ou syndic). Les champs ci-dessous seront intÃ©grÃ©s automatiquement dans le PDF.
      </p>

      <!-- Infos client -->
      <h3 class="section-title">1. Informations client</h3>
      <div class="row contract-grid">
        <div class="form-group">
          <label>CivilitÃ©</label>
          <select id="contractClientCivility">
            <option value="">â€”</option>
            <option value="Monsieur">Monsieur</option>
            <option value="Madame">Madame</option>
            <option value="Monsieur et Madame">Monsieur et Madame</option>
            <option value="SociÃ©tÃ©">SociÃ©tÃ©</option>
          </select>
        </div>

        <div class="form-group">
          <label>Nom / Raison sociale *</label>
          <input type="text" id="contractClientName" placeholder="Ex : M. Dupont, Syndic Martin & AssociÃ©s">
        </div>

        <div class="form-group">
          <label>Adresse *</label>
          <input type="text" id="contractClientAddress" placeholder="Adresse de facturation">
        </div>

        <div class="form-group">
          <label>TÃ©lÃ©phone</label>
          <input type="tel" id="contractClientPhone">
        </div>

        <div class="form-group">
          <label>Email</label>
          <input type="email" id="contractClientEmail">
        </div>

        <div class="form-group">
          <label>RÃ©fÃ©rence contrat (facultatif)</label>
          <input type="text" id="contractReference" placeholder="Ex : CTR-2025-001">
        </div>
      </div>

      <!-- Lieu dâ€™intervention -->
      <h3 class="section-title">2. Lieu dâ€™intervention</h3>
      <div class="row contract-grid">
        <div class="form-group">
          <label>CivilitÃ© lieu</label>
          <select id="contractSiteCivility">
            <option value="">â€”</option>
            <option value="Chez Monsieur">Chez Monsieur</option>
            <option value="Chez Madame">Chez Madame</option>
            <option value="Appartement Monsieur">Appartement Monsieur</option>
            <option value="Appartement Madame">Appartement Madame</option>
            <option value="Villa Monsieur">Villa Monsieur</option>
            <option value="Villa Madame">Villa Madame</option>
            <option value="RÃ©sidence">RÃ©sidence</option>
          </select>
        </div>

        <div class="form-group">
          <label>Nom sur place *</label>
          <input type="text" id="contractSiteName" placeholder="Ex : Mme Dupont Ã‰lise">
        </div>

        <div class="form-group">
          <label>Adresse du bassin *</label>
          <input type="text" id="contractSiteAddress" placeholder="Adresse complÃ¨te du bassin / rÃ©sidence">
        </div>
      </div>

      <!-- Bassin & technique -->
      <h3 class="section-title">3. CaractÃ©ristiques du bassin</h3>
      <div class="row contract-grid">
        <div class="form-group">
          <label>Type de bassin *</label>
          <select id="contractPoolType">
            <option value="">â€”</option>
            <option value="piscine au chlore">Piscine au chlore</option>
            <option value="piscine au sel">Piscine au sel</option>
            <option value="spa">Spa / Jacuzzi</option>
          </select>
        </div>

        <div class="form-group">
          <label>Traitement / Ã©quipement principal</label>
          <select id="contractTreatment">
            <option value="">â€”</option>
            <option value="traitement manuel">Traitement manuel</option>
            <option value="Ã©lectrolyseur au sel">Ã‰lectrolyseur au sel</option>
            <option value="rÃ©gulation automatique pH / redox">RÃ©gulation automatique pH / redox</option>
            <option value="autre Ã©quipement spÃ©cifique">Autre (prÃ©cisÃ© en observation)</option>
          </select>
        </div>

        <div class="form-group">
          <label>Volume approximatif</label>
          <input type="text" id="contractVolume" placeholder="Ex : 40 mÂ³">
        </div>

        <div class="form-group">
          <label>ParticularitÃ©s</label>
          <input type="text" id="contractSpecificities" placeholder="Couverture, volet, dÃ©bordement, local technique difficile dâ€™accÃ¨sâ€¦">
        </div>
      </div>

      <!-- FrÃ©quence & pÃ©riode -->
      <h3 class="section-title">4. FrÃ©quence & pÃ©riode dâ€™intervention</h3>
      <div class="row contract-grid">
        <div class="form-group">
          <label>FrÃ©quence des passages *</label>
          <select id="contractFrequency">
            <option value="">â€”</option>
            <option value="1 passage par semaine">1 passage par semaine</option>
            <option value="2 passages par semaine">2 passages par semaine</option>
            <option value="1 passage toutes les deux semaines">1 passage toutes les deux semaines</option>
            <option value="1 passage par mois">1 passage par mois</option>
          </select>
        </div>

        <div class="form-group">
          <label>PÃ©riode â€“ dÃ©but *</label>
          <input type="month" id="contractSeasonStart">
        </div>

        <div class="form-group">
          <label>PÃ©riode â€“ fin *</label>
          <input type="month" id="contractSeasonEnd">
        </div>

        <div class="form-group">
          <label>Jour / crÃ©neau souhaitÃ©</label>
          <input type="text" id="contractPreferredDay" placeholder="Ex : Le mardi matin, hors week-end et jours fÃ©riÃ©s">
        </div>
      </div>

       <!-- Montant & facturation -->
      <h3 class="section-title">5. Montant du contrat</h3>

      <!-- ğŸ”¢ CALCUL AUTOMATIQUE -->
      <div class="row contract-grid">
        <div class="form-group">
          <label>DÃ©but de contrat</label>
          <input type="date" id="contractCalcStart" onchange="onContractAutoChange()">
        </div>

        <div class="form-group">
          <label>DurÃ©e (en mois)</label>
          <select id="contractCalcDuration" onchange="onContractAutoChange()">
            <option value="4">4 mois</option>
            <option value="5">5 mois</option>
            <option value="6" selected>6 mois</option>
            <option value="12">12 mois</option>
          </select>
        </div>

        <div class="form-group">
          <label>Passages / mois en hiver</label>
          <input type="number" id="contractCalcVisitsWinter" min="0" step="1" value="1" oninput="onContractAutoChange()">
        </div>

        <div class="form-group">
          <label>Passages / mois en Ã©tÃ©</label>
          <input type="number" id="contractCalcVisitsSummer" min="0" step="1" value="2" oninput="onContractAutoChange()">
        </div>

        <div class="form-group">
          <label>Prix HT par passage</label>
          <input type="number" id="contractCalcPricePerVisit" step="0.01" value="70" oninput="onContractAutoChange()">
        </div>
      </div>

      <!-- RÃ©sumÃ© automatique -->
      <div class="totals" style="margin-top:10px;">
        <div class="total-line">
          <span>Nombre total de passages :</span>
          <span id="contractCalcTotalVisits">0</span>
        </div>
        <div class="total-line grand-total">
          <span>Montant total estimÃ© :</span>
          <span id="contractCalcTotalAmount">0,00 â‚¬</span>
        </div>
      </div>

      <!-- Zone de facturation (remplie automatiquement mais modifiable) -->
      <div class="row contract-grid" style="margin-top:15px;">
        <div class="form-group">
          <label>Mode de facturation *</label>
          <select id="contractBillingMode">
            <option value="">â€”</option>
            <option value="mensuelle">Facturation mensuelle</option>
            <option value="trimestrielle">Facturation trimestrielle</option>
            <option value="annuelle">Facturation annuelle</option>
          </select>
        </div>

        <div class="form-group">
          <label>Montant TTC de la pÃ©riode *</label>
          <input type="number" id="contractAmount" step="0.01" placeholder="Ex : 1800">
        </div>

        <div class="form-group">
          <label>PrÃ©cisions de rÃ¨glement</label>
          <input type="text" id="contractPaymentDetails" placeholder="Ex : Paiement Ã  rÃ©ception de facture, par virement">
        </div>
      </div>


      <!-- Observations -->
      <h3 class="section-title">6. Observations / clauses particuliÃ¨res</h3>
      <div class="form-group">
        <textarea id="contractNotes" placeholder="Ex : Bassin utilisÃ© par copropriÃ©tÃ©, attention aux horaires de calme, local technique accessible par clÃ©â€¦"></textarea>
      </div>

<div class="form-actions no-print">
  <button class="btn action-button" type="button" onclick="saveContract()">ğŸ’¾ Enregistrer le contrat</button>
  <button class="btn action-button" type="button" onclick="printContract()">ğŸ–¨ï¸ Imprimer le contrat</button>
  <button class="btn btn-secondary" type="button" onclick="backToListFromContract()">â† Retour</button>
</div>


    </div>
  </section>

  <!-- ================= POPUP CONFIRM CUSTOM ================= -->
  <div id="confirmOverlay" class="confirm-overlay hidden">
    <div class="confirm-box">

      <div class="confirm-icon" id="confirmIcon">âš ï¸</div>
      <h3 class="confirm-title" id="confirmTitle"></h3>
      <p class="confirm-message" id="confirmMessage"></p>

      <div class="confirm-buttons">
        <button id="confirmCancel" class="btn btn-secondary" type="button">Annuler</button>
        <button id="confirmOk" class="btn btn-danger" type="button">OK</button>
      </div>
    </div>
  </div>

  <!-- ================= POPUP LISTE CLIENTS ================= -->
  <div id="clientsPopup" class="popup-overlay hidden">
    <div class="popup">

      <h3>Liste des clients</h3>

      <!-- ğŸ” Barre de recherche -->
      <input
        type="text"
        id="clientSearchInput"
        placeholder="Rechercher un client..."
        oninput="filterClientsList()"
        style="width:100%; padding:8px; margin-bottom:12px; border-radius:6px; border:1px solid #ccc;"
      />

      <!-- ğŸ“‹ Liste clients -->
      <div id="clientsListContainer" class="client-list-box"></div>
<!-- Pagination -->
<div id="clientsPagination" class="clients-pagination">
  <button class="btn btn-secondary btn-small" type="button" onclick="prevClientsPage()">â—€</button>
  <span id="clientsPageInfo">Page 1 / 1</span>
  <button class="btn btn-secondary btn-small" type="button" onclick="nextClientsPage()">â–¶</button>
</div>
      <!-- âœï¸ Formulaire dâ€™Ã©dition -->
      <div id="editClientForm" class="hidden" style="margin-top:15px;">
        <h4>Modifier le client</h4>

        <label>Nom</label>
        <input type="text" id="editClientName">

        <label>Adresse</label>
        <input type="text" id="editClientAddress">

        <label>TÃ©lÃ©phone</label>
        <input type="text" id="editClientPhone">

        <label>Email</label>
        <input type="text" id="editClientEmail">

        <div style="margin-top:10px; display:flex; gap:10px;">
          <button class="btn btn-primary btn-small" onclick="saveEditedClient()">ğŸ’¾ Enregistrer</button>
          <button class="btn btn-secondary btn-small" onclick="cancelEditClient()">Annuler</button>
        </div>
      </div>

<!-- ğŸ“¤ Export CSV + Fermer -->
<div class="popup-buttons clients-footer">
  <div class="clients-footer-left">
    <button class="btn btn-primary btn-small btn-icon" type="button" onclick="openAddClientFromList()">
  <span class="btn-icon-emoji">â•</span>
  <span>Ajouter un client</span>
</button>

  </div>
  <div class="clients-footer-right">
    <button class="btn btn-primary btn-small" type="button" onclick="exportClientsCSV()">
      ğŸ“¤ Export CSV
    </button>
    <button class="btn btn-secondary btn-small" type="button" onclick="closeClientsListPopup()">
      Fermer
    </button>
  </div>
</div>
/* ===== PAGE CONTRAT ===== */

.contract-card {
  max-width: 980px;
  margin: 0 auto 20px auto;
}

.contract-intro {
  font-size: 13px;
  color: #555;
  margin-bottom: 12px;
}

.contract-grid .form-group {
  margin-bottom: 12px;
}


  </div> <!-- .popup -->
</div> <!-- #clientsPopup -->

</div> <!-- FIN container -->

<!-- App JS -->
<script src="app.js"></script>
</body>
</html>








