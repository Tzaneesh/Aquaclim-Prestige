<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AquaClim Prestige - Devis & Factures</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
</head>

<body>
<div class="container">

  <!-- EN-T√äTE -->
  <header class="header">
    <div class="header-inner">
      <img src="logo.png" alt="AquaClim Prestige" class="header-logo" />
      <div>
        <h1>AquaClim Prestige</h1>
        <p class="subtitle">Entretien & D√©pannage - Climatisation & Piscine</p>
        <p class="contact">
          Le Blevennec Lo√Øc ‚Äì 2 avenue Cauvin, 06100 Nice<br>
          T√©l : 06 03 53 77 73 ‚Äì Email : aquaclimprestige@gmail.com<br>
          SIRET : <strong>XXXXXXXXXXXXX</strong>
        </p>
      </div>
    </div>
  </header>

  <!-- ONGLET DEVIS / FACTURES -->
<div class="top-nav no-print">
  <button
    id="tabDevis"
    class="btn tab-btn active"
    onclick="switchListType('devis')"
  >
    üìÑ Devis
  </button>

  <!-- üëâ Nouveau bouton contrat ICI -->
  <button
    id="tabContrat"
    class="btn tab-btn"
    type="button"
    onclick="openContractView()"
  >
    üìò Contrat Piscine / Spa
  </button>

  <button
    id="tabFactures"
    class="btn tab-btn"
    onclick="switchListType('facture')"
  >
    üí∞ Factures
  </button>
</div>


  <!-- LISTE DES DOCUMENTS -->
  <section id="listView">

  <div class="actions no-print">
  <button id="createDevis" class="btn btn-primary" onclick="newDocument('devis')">
    ‚ûï Nouveau devis
  </button>

  <button id="createFacture" class="btn btn-success" onclick="newDocument('facture')">
    ‚ûï Nouvelle facture
  </button>

  <button class="btn btn-devis tarifs-button" onclick="openTarifsPanel()">
    üìã Tarifs prestations
  </button>

  <button
    class="btn btn-primary"
    type="button"
    onclick="openClientsListPopup()"
  >
    üë• Clients
  </button>
</div>


    <!-- PANEL TARIFS -->
    <div id="tarifsPanel" class="card no-print hidden">
      <h2>Tarifs des prestations</h2>

      <!-- actions top -->
      <div class="tarifs-actions tarifs-actions-top">
        <button class="btn btn-secondary" onclick="closeTarifsPanel()">‚Üê Retour</button>
        <button class="btn btn-primary" onclick="saveTarifsFromUI()">üíæ Enregistrer</button>
        <button class="btn btn-devis" onclick="openAddPrestationPopup()">‚ûï Ajouter</button>
        <button class="btn btn-danger" onclick="resetTarifs()">üßπ R√©initialiser</button>
      </div>

      <table class="documents-table">
        <thead>
          <tr>
            <th>Prestation</th>
            <th>Prix Particulier</th>
            <th>Prix Syndic</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="tarifsTableBody"></tbody>
      </table>

      <div id="descEditor" class="desc-editor hidden">
        <h4>Texte d√©taill√© du mod√®le</h4>
        <label>Texte Particulier</label>
        <textarea id="descPartInput"></textarea>

        <label>Texte Syndic / Agence</label>
        <textarea id="descSynInput"></textarea>

        <div class="desc-editor-buttons">
          <button class="btn btn-primary btn-small" onclick="saveDescEditor()">Enregistrer</button>
          <button class="btn btn-secondary btn-small" onclick="closeDescEditor()">Fermer</button>
        </div>
      </div>

      <div class="tarifs-actions tarifs-actions-bottom">
        <button class="btn btn-secondary" onclick="closeTarifsPanel()">‚Üê Retour</button>
        <button class="btn btn-primary" onclick="saveTarifsFromUI()">üíæ Enregistrer</button>
        <button class="btn btn-devis" onclick="openAddPrestationPopup()">‚ûï Ajouter</button>
        <button class="btn btn-danger" onclick="resetTarifs()">üßπ R√©initialiser</button>
      </div>
    </div>

    <!-- POPUP Ajouter prestation -->
    <div id="prestationPopup" class="popup-overlay hidden">
      <div class="popup">
        <h3 id="popupTitle">Nouvelle prestation</h3>

        <label>Nom de la prestation</label>
        <input type="text" id="popupName">

        <label>Prix Particulier</label>
        <input type="number" id="popupPricePart" step="0.01" oninput="onPopupPricePartChange()">

        <label>Prix Syndic</label>
        <input type="number" id="popupPriceSyn" step="0.01">

        <div class="popup-buttons">
          <button class="btn btn-primary" onclick="confirmPrestationPopup()">Valider</button>
          <button class="btn btn-secondary" onclick="closePrestationPopup()">Annuler</button>
        </div>
      </div>
    </div>

  <!-- TABLEAU DES DOCUMENTS -->
<div class="card">
  <div class="filters-row no-print">
    <span id="listTitle" class="list-title">Liste des devis</span>

    <!-- üîç Recherche devis / factures -->
    <div class="doc-search-wrapper">
      <input
        type="text"
        id="docSearchInput"
        placeholder="Rechercher (n¬∞, client, objet...)"
        oninput="onDocumentsSearchChange()"
      />
    </div>

    <div id="yearFilterContainer" class="hidden">
      <label>Ann√©e</label>
      <select id="yearFilter" onchange="loadDocumentsList()">
        <option value="all">Toutes</option>
      </select>
    </div>

    <div id="exportContainer" class="hidden">
      <button class="btn btn-secondary btn-small" onclick="exportFacturesCSV()">üì• Exporter (CSV)</button>
    </div>
  </div>


      <table class="documents-table">
        <thead>
          <tr>
            <th>Type</th>
            <th>Num√©ro</th>
            <th>Client</th>
            <th>Date</th>
            <th>Montant</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
        </thead>

        <tbody id="documentsTableBody">
          <tr><td colspan="7" class="no-docs-cell">Aucun document pour le moment</td></tr>
        </tbody>
      </table>
    </div>

  </section>

  <!-- FORMULAIRE DOCUMENT -->
  <section id="formView" class="hidden">

    <div class="actions no-print">
      <button class="btn btn-secondary" onclick="backToList()">‚Üê Retour</button>
      <button class="btn action-button" onclick="saveDocument()">üíæ Enregistrer</button>
      <button class="btn action-button" onclick="openPrintable()">üñ®Ô∏è Imprimer</button>
      <button class="btn action-button" onclick="duplicateCurrent()">üßæ Dupliquer</button>
      <button id="transformButton" class="btn action-button" style="display:none;" onclick="transformToInvoice()">üîÅ Facture</button>
      <button class="btn btn-danger" onclick="deleteCurrent()">üóëÔ∏è Supprimer</button>
    </div>

    <div class="card">
      <h2 id="formTitle">Nouveau document</h2>

      <!-- type document -->
      <div class="row">
        <div class="form-group">
          <label>Type *</label>
          <select id="docType" onchange="updateDocType(); updateTransformButtonVisibility();">
            <option value="devis">Devis</option>
            <option value="facture">Facture</option>
          </select>
        </div>

        <div class="form-group">
          <label>Num√©ro</label>
          <input type="text" id="docNumber" readonly>
        </div>

        <div class="form-group">
          <label>Date</label>
          <input type="date" id="docDate" onchange="onDocDateChange()">
        </div>

        <div class="form-group" id="validityDateGroup">
          <label>Valable jusqu‚Äôau</label>
          <input type="date" id="validityDate" onchange="onValidityChange()">
          <div id="devisStatusInfo" class="devis-status-info"></div>
        </div>
      </div>

      <div class="form-group">
        <label>Objet *</label>
        <input type="text" id="docSubject" placeholder="Ex : Entretien piscine + clim ‚Äì Villa Martin">
      </div>

      <!-- type client -->
      <div class="form-group">
        <label>Type client *</label>
        <div class="client-type-row">

          <label class="client-type-option">
            <input type="radio" name="clientType" value="particulier" id="clientParticulier" onchange="selectClientType('particulier')">
            Particulier
          </label>

          <label class="client-type-option">
            <input type="radio" name="clientType" value="syndic" id="clientSyndic" onchange="selectClientType('syndic')">
            Syndic / Agence
          </label>

        </div>
      </div>

      <!-- INFORMATIONS CLIENT -->
<h3 class="section-title">Informations client</h3>

<div class="row">
  <div class="form-group" style="max-width: 140px;">
    <label>Civilit√©</label>
    <select id="clientCivility">
      <option value="">‚Äî</option>
      <option value="Monsieur">Monsieur</option>
      <option value="Madame">Madame</option>
      <option value="Monsieur et Madame">Monsieur et Madame</option>
    </select>
  </div>

  <div class="form-group">
    <label>Nom ou Soci√©t√© *</label>
    <input
      type="text"
      id="clientName"
      list="clientsList"
      autocomplete="off"
      required
      onchange="onClientNameChange()"
      onblur="onClientNameChange()"
    />
    <datalist id="clientsList"></datalist>
  </div>

  <!-- (le reste de tes champs Adresse / T√©l√©phone / Email ne bouge pas) -->
</div>


        <div class="form-group">
          <label>Adresse *</label>
          <input type="text" id="clientAddress">
        </div>

        <div class="form-group">
          <label>T√©l√©phone</label>
          <input type="tel" id="clientPhone">
        </div>

        <div class="form-group">
          <label>Email</label>
          <input type="email" id="clientEmail">
        </div>
      </div>

      <!-- boutons clients -->
     <div class="row no-print" style="gap:10px; display:flex;">

  <!-- Ajouter client -->
  <button
    type="button"
    class="btn btn-primary btn-small btn-icon"
    onclick="addCurrentClient()"
  >
    <span class="btn-icon-emoji">‚ûï</span>
    <span>Ajouter ce client</span>
  </button>

  <!-- Voir liste clients -->
  <button
    type="button"
    class="btn btn-primary btn-small btn-icon"
    onclick="openClientsListPopup()"
  >
    <span class="btn-icon-emoji">üìã</span>
    <span>Voir liste clients</span>
  </button>

  <!-- Supprimer client -->
  <button
    type="button"
    class="btn btn-danger btn-small btn-icon"
    onclick="deleteCurrentClient()"
  >
    <span class="btn-icon-emoji">üóëÔ∏è</span>
    <span>Supprimer ce client</span>
  </button>

</div>

      <!-- Lieu d‚Äôintervention (si syndic/agence) -->
    <div id="siteBlock" class="row" style="display:none;">

  <div class="form-group" style="max-width: 150px;">
    <label>Civilit√© lieu</label>
    <select id="siteCivility" style="min-width: 250px;">

      <option value="">‚Äî</option>
      <option value="Chez Monsieur">Chez Monsieur</option>
      <option value="Chez Madame">Chez Madame</option>
      <option value="Appartement Monsieur">Appartement Monsieur</option>
      <option value="Appartement Madame">Appartement Madame</option>
      <option value="Villa Monsieur">Villa Monsieur</option>
      <option value="Villa Madame">Villa Madame</option>
    </select>
  </div>

  <div class="form-group">
    <label>Nom du client sur site *</label>
    <input type="text" id="siteName" placeholder="Ex : Mme Dupont √âlise">
  </div>

  <div class="form-group">
    <label>Adresse du lieu d‚Äôintervention *</label>
    <input type="text" id="siteAddress" placeholder="Ex : R√©sidence Le Parc, B√¢t A, 14 rue ...">
  </div>

</div>


      <!-- PRESTATIONS -->
      <div class="prestations-section">
        <h3 class="section-title">Prestations</h3>

        <div id="prestationsContainer"></div>

        <button id="addPrestationBtn" class="btn action-button no-print" onclick="addPrestation()">
          ‚ûï Ajouter une prestation
        </button>
      </div>

      <!-- TOTAUX -->
      <div class="totals">

        <div class="total-line">
          <span>Sous-total HT :</span>
          <span id="subtotalHT">0,00 ‚Ç¨</span>
        </div>

        <div class="totals-grid">

          <!-- R√©duction -->
          <div class="form-group discount-group">
            <label>R√©duction</label>
            <div class="discount-row">
              <label class="discount-toggle">
                <input type="checkbox" id="discountEnabled" onchange="onDiscountToggle()">
                Appliquer une r√©duction
              </label>

              <input type="number" id="discountPercentInput" min="0" max="100" value="0"
                     step="0.01" oninput="onDiscountPercentChange()" disabled>
              <span class="discount-percent-symbol">%</span>
            </div>
          </div>

          <!-- TVA -->
          <div class="form-group tva-group">
            <label>TVA</label>

            <div class="tva-options">
              <label><input type="radio" name="tvaRadio" id="tva0" checked onchange="setTVA(0)"> 0 %</label>
              <label><input type="radio" name="tvaRadio" id="tva20" onchange="setTVA(20)"> 20 %</label>
            </div>

            <div class="tva-rate-wrapper">
              <input type="number" id="tvaRate" value="0" step="0.01" readonly>
              <span class="tva-percent-symbol">%</span>
            </div>
          </div>

        </div>

        <div id="discountLine" class="total-line" style="display:none;">
          <span id="discountLabel">R√©duction :</span>
          <span id="discountAmount">0,00 ‚Ç¨</span>
        </div>

        <div class="total-line">
          <span>TVA :</span>
          <span id="tvaAmount">0,00 ‚Ç¨</span>
        </div>

        <div class="total-line grand-total">
          <span id="totalLabel">NET √Ä PAYER :</span>
          <span id="totalTTC">0,00 ‚Ç¨</span>
        </div>

        <div class="tva-note" id="tvaNote">TVA non applicable, article 293 B du CGI.</div>
      </div>

      <!-- SECTION PAIEMENT (factures) -->
      <div class="form-group no-print" id="paymentSection">
        <label>R√®glement</label>

        <div class="pay-line">
          <label><input type="radio" name="payMode" id="payNone" value="" checked onchange="onPayModeChange()"> Facture non r√©gl√©e</label>
        </div>

        <div class="pay-line">
          <label><input type="radio" name="payMode" value="especes" id="payEspeces" onchange="onPayModeChange()"> Esp√®ces</label>
          <label><input type="radio" name="payMode" value="cb" id="payCB" onchange="onPayModeChange()"> Carte bancaire</label>
          <label><input type="radio" name="payMode" value="virement" id="payVirement" onchange="onPayModeChange()"> Virement</label>
          <label><input type="radio" name="payMode" value="cheque" id="payCheque" onchange="onPayModeChange()"> Ch√®que</label>
        </div>

        <div id="paymentDateWrapper" class="payment-date-wrapper">
          <label>Date de r√®glement</label>
          <input type="date" id="paymentDate">
        </div>
      </div>

      <!-- Notes -->
      <div class="form-group">
        <label>Notes / Conditions</label>
        <textarea id="notes" placeholder="Conditions de paiement, garanties, etc."></textarea>
      </div>

      <!-- ACTIONS BAS -->
      <div class="form-actions no-print">
        <button class="btn action-button" onclick="saveDocument()">üíæ Enregistrer</button>
        <button class="btn action-button" onclick="openPrintable()">üñ®Ô∏è Imprimer</button>
        <button class="btn btn-secondary" onclick="backToList()">‚Üê Retour</button>
      </div>

    </div>
  </section>
    <!-- PAGE CONTRAT PISCINE / SPA -->
  <section id="contractView" class="hidden">

<div class="actions no-print">
  <button class="btn btn-secondary" type="button" onclick="backToListFromContract()">‚Üê Retour</button>
  <button class="btn action-button" type="button" onclick="saveContract()">üíæ Enregistrer le contrat</button>
  <button class="btn action-button" type="button" onclick="printContract()">üñ®Ô∏è Imprimer le contrat</button>
</div>


    <div class="card contract-card">
      <h2>Contrat d‚Äôentretien Piscine / Spa</h2>
      <p class="contract-intro">
        Ce formulaire g√©n√®re un contrat d‚Äôentretien complet pr√™t √† √™tre sign√© par le client
        (particulier ou syndic). Les champs ci-dessous seront int√©gr√©s automatiquement dans le PDF.
      </p>

      <!-- Infos client -->
      <h3 class="section-title">1. Informations client</h3>
      <div class="row contract-grid">
        <div class="form-group">
          <label>Civilit√©</label>
          <select id="contractClientCivility">
            <option value="">‚Äî</option>
            <option value="Monsieur">Monsieur</option>
            <option value="Madame">Madame</option>
            <option value="Monsieur et Madame">Monsieur et Madame</option>
            <option value="Soci√©t√©">Soci√©t√©</option>
          </select>
        </div>

        <div class="form-group">
          <label>Nom / Raison sociale *</label>
          <input type="text" id="contractClientName" placeholder="Ex : M. Dupont, Syndic Martin & Associ√©s">
        </div>

        <div class="form-group">
          <label>Adresse *</label>
          <input type="text" id="contractClientAddress" placeholder="Adresse de facturation">
        </div>

        <div class="form-group">
          <label>T√©l√©phone</label>
          <input type="tel" id="contractClientPhone">
        </div>

        <div class="form-group">
          <label>Email</label>
          <input type="email" id="contractClientEmail">
        </div>

        <div class="form-group">
          <label>R√©f√©rence contrat (facultatif)</label>
          <input type="text" id="contractReference" placeholder="Ex : CTR-2025-001">
        </div>
      </div>

      <!-- Lieu d‚Äôintervention -->
      <h3 class="section-title">2. Lieu d‚Äôintervention</h3>
      <div class="row contract-grid">
        <div class="form-group">
          <label>Civilit√© lieu</label>
          <select id="contractSiteCivility">
            <option value="">‚Äî</option>
            <option value="Chez Monsieur">Chez Monsieur</option>
            <option value="Chez Madame">Chez Madame</option>
            <option value="Appartement Monsieur">Appartement Monsieur</option>
            <option value="Appartement Madame">Appartement Madame</option>
            <option value="Villa Monsieur">Villa Monsieur</option>
            <option value="Villa Madame">Villa Madame</option>
            <option value="R√©sidence">R√©sidence</option>
          </select>
        </div>

        <div class="form-group">
          <label>Nom sur place *</label>
          <input type="text" id="contractSiteName" placeholder="Ex : Mme Dupont √âlise">
        </div>

        <div class="form-group">
          <label>Adresse du bassin *</label>
          <input type="text" id="contractSiteAddress" placeholder="Adresse compl√®te du bassin / r√©sidence">
        </div>
      </div>

      <!-- Bassin & technique -->
      <h3 class="section-title">3. Caract√©ristiques du bassin</h3>
      <div class="row contract-grid">
        <div class="form-group">
          <label>Type de bassin *</label>
          <select id="contractPoolType">
            <option value="">‚Äî</option>
            <option value="piscine au chlore">Piscine au chlore</option>
            <option value="piscine au sel">Piscine au sel</option>
            <option value="spa">Spa / Jacuzzi</option>
          </select>
        </div>

        <div class="form-group">
          <label>Traitement / √©quipement principal</label>
          <select id="contractTreatment">
            <option value="">‚Äî</option>
            <option value="traitement manuel">Traitement manuel</option>
            <option value="√©lectrolyseur au sel">√âlectrolyseur au sel</option>
            <option value="r√©gulation automatique pH / redox">R√©gulation automatique pH / redox</option>
            <option value="autre √©quipement sp√©cifique">Autre (pr√©cis√© en observation)</option>
          </select>
        </div>

        <div class="form-group">
          <label>Volume approximatif</label>
          <input type="text" id="contractVolume" placeholder="Ex : 40 m¬≥">
        </div>

        <div class="form-group">
          <label>Particularit√©s</label>
          <input type="text" id="contractSpecificities" placeholder="Couverture, volet, d√©bordement, local technique difficile d‚Äôacc√®s‚Ä¶">
        </div>
      </div>

       <!-- Fr√©quence & p√©riode -->
      <h3 class="section-title">4. Fr√©quence & p√©riode d‚Äôintervention</h3>
      <div class="row contract-grid">

        <!-- D√©but + dur√©e servent aussi au calcul -->
        <div class="form-group">
          <label>D√©but de contrat *</label>
          <input type="date" id="contractCalcStart" onchange="onContractAutoChange()">
        </div>

        <div class="form-group">
          <label>Dur√©e du contrat</label>
          <select id="contractCalcDuration" onchange="onContractAutoChange()">
            <option value="4">4 mois</option>
            <option value="5">5 mois</option>
            <option value="6" selected>6 mois</option>
            <option value="12">12 mois</option>
          </select>
        </div>

        <!-- Presets simples -->
        <div class="form-group">
          <label>Mode de passages *</label>
          <select id="contractVisitsMode" onchange="onContractVisitsModeChange()">
            <option value="standard" selected>Standard : 1/mois hiver ‚Äì 2/mois √©t√©</option>
            <option value="intensif">Intensif : 2/mois hiver ‚Äì 4/mois √©t√©</option>
            <option value="perso">Personnalis√©</option>
          </select>
        </div>

        <!-- Valeurs d√©taill√©es, auto ou personnalis√©es -->
        <div class="form-group" id="customVisitsBlock" style="display:none;">
          <label>Passages par mois (hiver / √©t√©)</label>
          <div style="display:flex; gap:8px;">
            <input type="number" id="contractCalcVisitsWinter" min="0" step="1" value="1" oninput="onContractAutoChange()">
            <input type="number" id="contractCalcVisitsSummer" min="0" step="1" value="2" oninput="onContractAutoChange()">
          </div>
        </div>

        <div class="form-group">
          <label>Jour / cr√©neau souhait√©</label>
          <input type="text" id="contractPreferredDay" placeholder="Ex : Le mardi matin, hors week-end et jours f√©ri√©s">
        </div>

        <!-- P√©riode affich√©e automatiquement (lecture seule) -->
        <div class="form-group">
          <label>P√©riode ‚Äì d√©but</label>
          <input type="month" id="contractSeasonStart" readonly>
        </div>

        <div class="form-group">
          <label>P√©riode ‚Äì fin</label>
          <input type="month" id="contractSeasonEnd" readonly>
        </div>
      </div>


       <!-- Montant & facturation -->
      <h3 class="section-title">5. Montant du contrat</h3>

      <!-- üî¢ CALCUL AUTOMATIQUE -->
      <div class="row contract-grid">
        <div class="form-group">
          <label>D√©but de contrat</label>
          <input type="date" id="contractCalcStart" onchange="onContractAutoChange()">
        </div>

        <div class="form-group">
          <label>Dur√©e (en mois)</label>
          <select id="contractCalcDuration" onchange="onContractAutoChange()">
            <option value="4">4 mois</option>
            <option value="5">5 mois</option>
            <option value="6" selected>6 mois</option>
            <option value="12">12 mois</option>
          </select>
        </div>

        <div class="form-group">
          <label>Passages / mois en hiver</label>
          <input type="number" id="contractCalcVisitsWinter" min="0" step="1" value="1" oninput="onContractAutoChange()">
        </div>

        <div class="form-group">
          <label>Passages / mois en √©t√©</label>
          <input type="number" id="contractCalcVisitsSummer" min="0" step="1" value="2" oninput="onContractAutoChange()">
        </div>

        <div class="form-group">
          <label>Prix HT par passage</label>
          <input type="number" id="contractCalcPricePerVisit" step="0.01" value="70" oninput="onContractAutoChange()">
        </div>
      </div>

      <!-- R√©sum√© automatique -->
      <div class="totals" style="margin-top:10px;">
        <div class="total-line">
          <span>Nombre total de passages :</span>
          <span id="contractCalcTotalVisits">0</span>
        </div>
        <div class="total-line grand-total">
          <span>Montant total estim√© :</span>
          <span id="contractCalcTotalAmount">0,00 ‚Ç¨</span>
        </div>
      </div>

      <!-- Zone de facturation (remplie automatiquement mais modifiable) -->
      <div class="row contract-grid" style="margin-top:15px;">
        <div class="form-group">
          <label>Mode de facturation *</label>
          <select id="contractBillingMode">
            <option value="">‚Äî</option>
            <option value="mensuelle">Facturation mensuelle</option>
            <option value="trimestrielle">Facturation trimestrielle</option>
            <option value="annuelle">Facturation annuelle</option>
          </select>
        </div>

        <div class="form-group">
          <label>Montant TTC de la p√©riode *</label>
          <input type="number" id="contractAmount" step="0.01" placeholder="Ex : 1800">
        </div>

        <div class="form-group">
          <label>Pr√©cisions de r√®glement</label>
          <input type="text" id="contractPaymentDetails" placeholder="Ex : Paiement √† r√©ception de facture, par virement">
        </div>
      </div>


      <!-- Observations -->
      <h3 class="section-title">6. Observations / clauses particuli√®res</h3>
      <div class="form-group">
        <textarea id="contractNotes" placeholder="Ex : Bassin utilis√© par copropri√©t√©, attention aux horaires de calme, local technique accessible par cl√©‚Ä¶"></textarea>
      </div>

<div class="form-actions no-print">
  <button class="btn action-button" type="button" onclick="saveContract()">üíæ Enregistrer le contrat</button>
  <button class="btn action-button" type="button" onclick="printContract()">üñ®Ô∏è Imprimer le contrat</button>
  <button class="btn btn-secondary" type="button" onclick="backToListFromContract()">‚Üê Retour</button>
</div>


    </div>
  </section>

  <!-- ================= POPUP CONFIRM CUSTOM ================= -->
  <div id="confirmOverlay" class="confirm-overlay hidden">
    <div class="confirm-box">

      <div class="confirm-icon" id="confirmIcon">‚ö†Ô∏è</div>
      <h3 class="confirm-title" id="confirmTitle"></h3>
      <p class="confirm-message" id="confirmMessage"></p>

      <div class="confirm-buttons">
        <button id="confirmCancel" class="btn btn-secondary" type="button">Annuler</button>
        <button id="confirmOk" class="btn btn-danger" type="button">OK</button>
      </div>
    </div>
  </div>

  <!-- ================= POPUP LISTE CLIENTS ================= -->
  <div id="clientsPopup" class="popup-overlay hidden">
    <div class="popup">

      <h3>Liste des clients</h3>

      <!-- üîç Barre de recherche -->
      <input
        type="text"
        id="clientSearchInput"
        placeholder="Rechercher un client..."
        oninput="filterClientsList()"
        style="width:100%; padding:8px; margin-bottom:12px; border-radius:6px; border:1px solid #ccc;"
      />

      <!-- üìã Liste clients -->
      <div id="clientsListContainer" class="client-list-box"></div>
<!-- Pagination -->
<div id="clientsPagination" class="clients-pagination">
  <button class="btn btn-secondary btn-small" type="button" onclick="prevClientsPage()">‚óÄ</button>
  <span id="clientsPageInfo">Page 1 / 1</span>
  <button class="btn btn-secondary btn-small" type="button" onclick="nextClientsPage()">‚ñ∂</button>
</div>
      <!-- ‚úèÔ∏è Formulaire d‚Äô√©dition -->
      <div id="editClientForm" class="hidden" style="margin-top:15px;">
        <h4>Modifier le client</h4>

        <label>Nom</label>
        <input type="text" id="editClientName">

        <label>Adresse</label>
        <input type="text" id="editClientAddress">

        <label>T√©l√©phone</label>
        <input type="text" id="editClientPhone">

        <label>Email</label>
        <input type="text" id="editClientEmail">

        <div style="margin-top:10px; display:flex; gap:10px;">
          <button class="btn btn-primary btn-small" onclick="saveEditedClient()">üíæ Enregistrer</button>
          <button class="btn btn-secondary btn-small" onclick="cancelEditClient()">Annuler</button>
        </div>
      </div>

<!-- üì§ Export CSV + Fermer -->
<div class="popup-buttons clients-footer">
  <div class="clients-footer-left">
    <button class="btn btn-primary btn-small btn-icon" type="button" onclick="openAddClientFromList()">
  <span class="btn-icon-emoji">‚ûï</span>
  <span>Ajouter un client</span>
</button>

  </div>
  <div class="clients-footer-right">
    <button class="btn btn-primary btn-small" type="button" onclick="exportClientsCSV()">
      üì§ Export CSV
    </button>
    <button class="btn btn-secondary btn-small" type="button" onclick="closeClientsListPopup()">
      Fermer
    </button>
  </div>
</div>
/* ===== PAGE CONTRAT ===== */

.contract-card {
  max-width: 980px;
  margin: 0 auto 20px auto;
}

.contract-intro {
  font-size: 13px;
  color: #555;
  margin-bottom: 12px;
}

.contract-grid .form-group {
  margin-bottom: 12px;
}


  </div> <!-- .popup -->
</div> <!-- #clientsPopup -->

</div> <!-- FIN container -->

<!-- App JS -->
<script src="app.js"></script>
</body>
</html>









